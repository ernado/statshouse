"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[53],{2098:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var i=t(5893),s=t(1151);const r=t.p+"assets/images/metric-types-cf304c98d8d3147e9ed9f132da1d644c.png",o={sidebar_position:3,description:"Get to know how to set up metric types, tags, resolution, and more."},a="Configure your metric",c={id:"guides/configure-metric",title:"Configure your metric",description:"Get to know how to set up metric types, tags, resolution, and more.",source:"@site/docs/guides/configure-metric.md",sourceDirName:"guides",slug:"/guides/configure-metric",permalink:"/statshouse/guides/configure-metric",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3,description:"Get to know how to set up metric types, tags, resolution, and more."},sidebar:"tutorialSidebar",previous:{title:"Create a metric",permalink:"/statshouse/guides/create-metric"},next:{title:"Refer to existing metrics",permalink:"/statshouse/guides/refer-to-existing-metrics"}},d={},l=[{value:"Metric type",id:"metric-type",level:2},{value:"Tags",id:"tags",level:2},{value:"Description",id:"description",level:2},{value:"Aggregation",id:"aggregation",level:2},{value:"Percentiles",id:"percentiles",level:2},{value:"Resolution",id:"resolution",level:2},{value:"Units",id:"units",level:2},{value:"Weight",id:"weight",level:2},{value:"Metric groups",id:"metric-groups",level:2},{value:"Advanced metric options",id:"advanced-metric-options",level:2},{value:"Changing or combining metric types",id:"changing-or-combining-metric-types",level:3},{value:"User-guided sampling",id:"user-guided-sampling",level:3},{value:"Disabling a metric",id:"disabling-a-metric",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"configure-your-metric",children:"Configure your metric"}),"\n",(0,i.jsx)(n.p,{children:"Before you start configuring metrics, you may have a question:"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"Can I skip configuration for my metric?"'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["No. As soon as your metric has a name, you have to specify a ",(0,i.jsx)(n.a,{href:"#metric-type",children:"metric type"})," in your sending requests.\nThen, you can configure more parameters for advanced usage, or start sending data right away."]}),"\n",(0,i.jsx)(n.p,{children:"For the full list of configuration options, see the upper-right navigation menu on this page."}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Do not commit configuration changes or send data to someone else's metric as you can spoil the metric or the related data."})}),"\n",(0,i.jsx)(n.h2,{id:"metric-type",children:"Metric type"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"What is a metric type? Why do I have to specify it?"'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["A metric is a ",(0,i.jsx)(n.a,{href:"https://dictionary.cambridge.org/dictionary/english/metric",children:"system for measuring something"}),"\u2014it\nis ",(0,i.jsx)(n.em,{children:"how you measure"})," the things you are interested in."]}),"\n",(0,i.jsx)(n.p,{children:"You can measure same things in different ways. To evaluate service availability, you can count the\nnumber of handled requests, which is just a number of events; or you can measure processing time for these requests,\nwhich is the value accompanying each event (each request)."}),"\n",(0,i.jsx)(n.p,{children:"StatsHouse is a powerful tool, but it cannot decide for you, so you should clearly understand what you want to\nmeasure, and how you will measure it."}),"\n",(0,i.jsxs)(n.admonition,{type:"important",children:[(0,i.jsxs)(n.p,{children:["A metric type affects the range of\n",(0,i.jsx)(n.a,{href:"view-graph#desriptive-statistics-available-for-a-metric",children:"descriptive statistics"})," available for your metric to view\nand analyze. For example, you cannot calculate the sum for unique counters (you can, but this sum is meaningless);\nand percentiles are available for values only."]}),(0,i.jsxs)(n.p,{children:["See more about ",(0,i.jsx)(n.a,{href:"#enable-percentiles",children:"enabling percentiles"}),"\nand ",(0,i.jsx)(n.a,{href:"#aggregation",children:"showing the proper descriptive statistics"})," in the UI."]})]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"Which metric types are available in StatsHouse?"'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"With StatsHouse, you can use three basic metric types."}),"\n",(0,i.jsx)("img",{src:r,width:"800"}),"\n",(0,i.jsx)(n.p,{children:"See the table below for definitions and examples:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric type"}),(0,i.jsx)(n.th,{children:"What does it measure?"}),(0,i.jsx)(n.th,{children:"Examples"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Counter"}),(0,i.jsx)(n.td,{children:"It counts the number of times an event has occurred."}),(0,i.jsxs)(n.td,{children:["The number of API method calls",(0,i.jsx)("br",{}),"The number of requests to a server",(0,i.jsx)("br",{}),"The number of errors received while sending messages"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Value metric"}),(0,i.jsxs)(n.td,{children:["It measures magnitude of a parameter.",(0,i.jsx)("br",{}),"A measurement event itself is counted as well."]}),(0,i.jsxs)(n.td,{children:["How long does it take ",(0,i.jsx)("br",{}),"for a service to generate a newsfeed?",(0,i.jsx)("br",{}),"What is CPU usage for this host?",(0,i.jsx)("br",{}),"What is the response size (in bytes)?"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Unique counter"}),(0,i.jsxs)(n.td,{children:["It counts the number of unique events.",(0,i.jsx)("br",{}),"The total number of events is counted as well."]}),(0,i.jsx)(n.td,{children:"The number of unique users who sent packages to a service"})]})]})]}),"\n",(0,i.jsx)(n.p,{children:"Value metrics and unique counters have an ordinary counter inside so that you should not implement your own counters\nfor these metric types. Imagine you measuring a value metric (e.g. the\nresponse size in bytes) once in a second:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'You get the "value level" that is your parameter magnitude:\n1024 bytes, then 2048 bytes, etc. Please note that this "level" is [aggregation], not an exact value for a\nparticular moment in time.'}),"\n",(0,i.jsx)(n.li,{children:'You also get the "counter" for your value metric that shows the number of times you performed\nyour measurements: +1 for the first second, +1 for the next one, etc.'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The same applies to unique counters: they\nprovide you with both the number of unique events and the total number of events.\nSee more on\n",(0,i.jsx)(n.a,{href:"#changing-or-combining-metric-types",children:"changing or combining metric types"}),"\nand ",(0,i.jsx)(n.a,{href:"#user-guided-sampling",children:"user-guided sampling"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Metric types should not be confused with ",(0,i.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Data_type",children:"data types"})," in programming\nlanguages. You should not specify the type of your data: whether it is ",(0,i.jsx)(n.code,{children:"int"}),", ",(0,i.jsx)(n.code,{children:"float"}),", or ",(0,i.jsx)(n.code,{children:"double"}),", etc."]})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"OK. How can I configure my metric type?"'}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You should specify a ",(0,i.jsx)(n.a,{href:"#metric-type",children:"metric type"})," in your sending requests."]}),"\n",(0,i.jsxs)(n.p,{children:["For a toy example, you may send your metric data with one of these ",(0,i.jsx)(n.code,{children:"bash"})," scripts:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo \'{"metrics":[{"name":"my_metric","tags":{},"counter":1000}]}\' | nc -q 1 -u 127.0.0.1 13337\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'echo \'{"metrics":[{"name":"my_metric","tags":{},"value":1000}]}\' | nc -q 1 -u 127.0.0.1 13337\n'})}),"\n",(0,i.jsxs)(n.p,{children:["where ",(0,i.jsx)(n.code,{children:"counter"})," or ",(0,i.jsx)(n.code,{children:"value"})," are the metric types."]}),"\n",(0,i.jsxs)(n.p,{children:["You can also use one of the client libraries. For example, with the\n",(0,i.jsx)(n.a,{href:"https://github.com/VKCOM/statshouse-py/tree/master",children:"StatsHouse client library for Python"}),", you have\nto choose one of these methods according to your metric type:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Python",children:'statshouse.count("my_metric", {}, 0.42)\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Python",children:'statshouse.value("my_metric", {}, 0.42)\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-Python",children:'statshouse.unique("my_metric", {}, 0.42)\n'})}),"\n",(0,i.jsx)(n.p,{children:"Having done this, you may send your data, or continue configuring metric parameters."}),"\n",(0,i.jsx)(n.h2,{id:"tags",children:"Tags"}),"\n",(0,i.jsxs)(n.p,{children:["You can ",(0,i.jsx)(n.a,{href:"/statshouse/guides/send-data",children:"start sending data"})," to your metric with no additional configuration.\nStatsHouse does everything for you, but it may lead to increased sampling. In most cases, you do not need\nto worry about sampling, but if you are not sure, check the [conceptual overview]."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Sampling prevents StatsHouse from database overload. If you send too much, StatsHouse ",(0,i.jsx)(n.em,{children:"samples"}),"\ndata: it removes random data rows and multiplies the remaining ones so that the resulting aggregation and\ndigests stay the same. Find more about [sampling], [aggregation], and [digests]."]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://prometheus.io/docs/practices/naming/",children:"https://prometheus.io/docs/practices/naming/"})}),"\n",(0,i.jsx)(n.p,{children:"Use labels to differentiate the characteristics of the thing that is being measured:"}),"\n",(0,i.jsx)(n.p,{children:'api_http_requests_total - differentiate request types: operation="create|update|delete"\napi_request_duration_seconds - differentiate request stages: stage="extract|transform|load"\nDo not put the label names in the metric name, as this introduces redundancy and will cause confusion if the respective labels are aggregated away.'}),"\n",(0,i.jsx)(n.p,{children:"Remember that every unique combination of key-value label pairs represents a new time series, which can dramatically\nincrease the amount of data stored. Do not use labels to store dimensions with high cardinality (many different\nlabel values), such as user IDs, email addresses, or other unbounded sets of values."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://www.robustperception.io/cardinality-is-key/",children:"https://www.robustperception.io/cardinality-is-key/"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"How many tags are allowed?"'}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"How many tag values are allowed?"'}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:'"What are tag ID, name, and description?"'}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:['"What are ',(0,i.jsx)(n.em,{children:"Raw"}),' tags and value comments"']}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,i.jsx)(n.p,{children:"Description is for UI only. New lines are respected, no other formatting supported yet."}),"\n",(0,i.jsx)(n.h2,{id:"aggregation",children:"Aggregation"}),"\n",(0,i.jsx)(n.p,{children:"CounterValueUniqueMixed"}),"\n",(0,i.jsx)(n.h2,{id:"percentiles",children:"Percentiles"}),"\n",(0,i.jsx)(n.p,{children:"Aggregation defines which functions (count, avg, sum, etc.) are available in UI. Mixed allows all functions. Enabling percentiles greatly increase data volume collected.\nResolution\n1 second (native, default)2 seconds3 seconds4 seconds5 seconds (native)6 seconds10 seconds12 seconds15 seconds (native)20 seconds30 seconds60 seconds (native)\nIf your metric is heavily sampled, you can trade time resolution for reduced sampling. Selecting non-native resolution might render with surprises in UI.\nUnit\nno unitsecondmillisecondmicrosecondnanosecondbyte\nThe unit in which the metric is written\nWeight"}),"\n",(0,i.jsx)(n.p,{children:"Important metrics can have their data budget proportionally increased. Will reduce other metrics budgets so can be enabled only by administrator.\nTags"}),"\n",(0,i.jsx)(n.h2,{id:"resolution",children:"Resolution"}),"\n",(0,i.jsx)(n.h2,{id:"units",children:"Units"}),"\n",(0,i.jsx)(n.p,{children:"no unitsecondmillisecondmicrosecondnanosecondbyte\nThe unit in which the metric is written"}),"\n",(0,i.jsx)(n.h2,{id:"weight",children:"Weight"}),"\n",(0,i.jsx)(n.p,{children:"Important metrics can have their data budget proportionally increased. Will reduce other metrics budgets so can be enabled only by administrator."}),"\n",(0,i.jsx)(n.h2,{id:"metric-groups",children:"Metric groups"}),"\n",(0,i.jsx)(n.h2,{id:"advanced-metric-options",children:"Advanced metric options"}),"\n",(0,i.jsx)(n.h3,{id:"changing-or-combining-metric-types",children:"Changing or combining metric types"}),"\n",(0,i.jsx)(n.h3,{id:"user-guided-sampling",children:"User-guided sampling"}),"\n",(0,i.jsx)(n.h2,{id:"disabling-a-metric",children:"Disabling a metric"}),"\n",(0,i.jsx)(n.p,{children:"Disabling metric stops data recording for this metric and removes it from all lists.\nThis is most close thing to deleting metric (which statshouse does not support).\nYou will need a direct link to enable metric again."}),"\n",(0,i.jsx)(n.p,{children:"If you disable a metric, you stop recording data for it and remove it from the metric\nlist. You can enable the metric only via the direct link."})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>o});var i=t(7294);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);